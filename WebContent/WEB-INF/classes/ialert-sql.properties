7DAYSHISTORY = SELECT TO_CHAR(DATA_DATE , ''MM/DD/YYYY HH12\:MI\:SS AM'') as dataDate,REGION as region, TO_CHAR(APT_ACTUAL_START, ''MM/DD/YYYY HH12\:MI\:SS AM'') as aptActualStart, TO_CHAR(APT_ACTUAL_END, ''MM/DD/YYYY HH12\:MI\:SS AM'') as aptActualEnd ,\n TO_CHAR(APT_30DAY_AVG_START, ''MM/DD/YYYY HH12\:MI\:SS AM'')  as apt30DayAvgStart , TO_CHAR(APT_30DAY_AVG_END, ''MM/DD/YYYY HH12\:MI\:SS AM'') as apt30DayAvgEnd ,TO_CHAR(APT_SLA_END, ''MM/DD/YYYY HH12:MI:SS AM'') AS aptSLAEnd, TO_CHAR(OFA_ACTUAL_START, ''MM/DD/YYYY HH12\:MI\:SS AM'')  as  ofaActualStart ,\n TO_CHAR(OFA_ACTUAL_END, ''MM/DD/YYYY HH12\:MI\:SS AM'')   as  ofaActualEnd ,TO_CHAR(OFA_30DAY_AVG_START, ''MM/DD/YYYY HH12\:MI\:SS AM'') as  ofa30DayAvgStart, TO_CHAR(OFA_30DAY_AVG_END, ''MM/DD/YYYY HH12\:MI\:SS AM'')  as ofa30DayAvgEnd , TO_CHAR(OFA_SLA_END, ''MM/DD/YYYY HH12:MI:SS AM'') AS ofaSLAEnd,  \n TO_CHAR(UAD_ACTUAL_START, ''MM/DD/YYYY HH12\:MI\:SS AM'') as  uadActualStart,TO_CHAR(UAD_ACTUAL_END, ''MM/DD/YYYY HH12\:MI\:SS AM'')   as uadActualEnd , TO_CHAR(UAD_30DAY_AVG_START, ''MM/DD/YYYY HH12\:MI\:SS AM'') as  uad30DayAvgStart ,\n TO_CHAR(UAD_30DAY_AVG_END, ''MM/DD/YYYY HH12\:MI\:SS AM'')  as  uad30DayAvgEnd , TO_CHAR(UAD_SLA_END, ''MM/DD/YYYY HH12\:MI\:SS AM'')  as  uadSLAEnd ,TO_CHAR(APT_TRAF_ACTUAL_START, ''MM/DD/YYYY HH12\:MI\:SS AM'')  as aptTrafActualStart  ,\n TO_CHAR(APT_TRAF_ACTUAL_END, ''MM/DD/YYYY HH12\:MI\:SS AM'')  as   aptTrafActualEnd ,  TO_CHAR(APT_TRAF_30DAY_AVG_START, ''MM/DD/YYYY HH12\:MI\:SS AM'')   as  aptTraf30DayAvgStart ,TO_CHAR(APT_TRAF_30DAY_AVG_END, ''MM/DD/YYYY HH12\:MI\:SS AM'') as aptTraf30DayAvgEnd ,TO_CHAR(APT_TRAF_ACTUAL_END, ''MM/DD/YYYY HH12\:MI\:SS AM'') as aptTrafActualEnd ,TO_CHAR(APT_TRAF_SLA_END, ''MM/DD/YYYY HH12\:MI\:SS AM'') as aptTrafSLAEnd \n FROM {0}.UAD_SLA_DASHBOARD_HISTORY WHERE DATA_DATE BETWEEN to_date(?,''DD-MON-YY'')-6 and to_date(?,''DD-MON-YY'') and lower(REGION) \= ?
																																																																																																																																																																																																																																																																																																																																																																																																		
7DAYSALERT=SELECT UAD_SLA_DB_MESG_ID as messageId ,DATETIME as alertDate,MESSAGE_FROM as messageFrom, MESSAGE_HEADER as messageHeader,MESSAGE_BODY as messageBody FROM \n {0} .UAD_SLA_DASHBOARD_MESSAGE where DATETIME > \= sysdate -7 order by DATETIME asc, UAD_SLA_DB_MESG_ID

ALERT_DETAIL= SELECT UAD_SLA_DB_MESG_ID as messageId ,DATETIME as alertDate,MESSAGE_FROM as messageFrom, MESSAGE_HEADER as messageHeader,MESSAGE_BODY as messageBody \n FROM  {0} .UAD_SLA_DASHBOARD_MESSAGE where UAD_SLA_DB_MESG_ID \= ?

REGIONLIST= SELECT  REGION,  TO_CHAR(DATA_DATE, 'DD-MON-YYYY') DATADATE,  TO_CHAR(SYSDATE - ((CASE WHEN TZ_OFFSET('US/Pacific')=TZ_OFFSET('-08:00') THEN 8 ELSE 7 END)/24), 'DD-MON-YYYY HH12:MI AM') CURRENT_AMERICAS_DATE, TO_CHAR(SYSDATE + (5.5/24), 'DD-MON-YYYY HH12:MI AM') CURRENT_APAC_DATE, TO_CHAR(SYSDATE, 'DD-MON-YYYY HH12:MI AM') CURRENT_EMEA_DATE, TO_CHAR(APT_SLA_START, 'HH12:MI AM') APTSLASTARTTIME,  TO_CHAR(APT_SLA_END, 'HH12:MI AM') APTSLAENDTIME,  ROUND((((CASE REGION  WHEN 'APAC' THEN ((sysdate + (5.5/24)) - APT_SLA_END) * 24 * 60 WHEN 'EMEA' THEN (sysdate - APT_SLA_END) * 24 * 60 ELSE ((sysdate - ((CASE WHEN TZ_OFFSET('US/Pacific')=TZ_OFFSET('-08:00') THEN 8 ELSE 7 END)/24)) - APT_SLA_END) * 24 * 60  END) * 100) / (CASE WHEN ((APT_SLA_END - APT_SLA_START) * 24 * 60) <=0 THEN 1 ELSE ((APT_SLA_END - APT_SLA_START) * 24 * 60) END)),0) APTSLAPERCENT, TO_CHAR(ACTUAL_APT_SLA_START, 'HH12:MI AM') APTSTARTTIME,  TO_CHAR(NVL(ACTUAL_APT_SLA_END, APT_ETA), 'HH12:MI AM') APTENDTIME,  (CASE NVL(TO_CHAR(ACTUAL_APT_SLA_START, 'HH12:MI AM'), 'N')    WHEN 'N' THEN 'Not Started'    ELSE      (CASE NVL(TO_CHAR(ACTUAL_APT_SLA_END, 'HH12:MI AM'), 'N')       WHEN 'N' THEN 'Running'       ELSE 'Completed'     END) END) APTLOADSTATUS, (CASE     WHEN ((APT_ETA-APT_SLA_END)*24*60) <= 0 THEN 'GREEN'   WHEN (((APT_ETA-APT_SLA_END)*24*60)>0 AND ((APT_ETA-APT_SLA_END)*24*60) <=60) THEN 'AMBER'   WHEN ((APT_ETA-APT_SLA_END)*24*60) >60 THEN 'RED' END) APTSTATUS, ROUND((((CASE REGION  WHEN 'APAC' THEN ((sysdate + (5.5/24)) - NVL(ACTUAL_APT_SLA_END, APT_ETA)) * 24 * 60 WHEN 'EMEA' THEN (sysdate - NVL(ACTUAL_APT_SLA_END, APT_ETA)) * 24 * 60 ELSE ((sysdate - ((CASE WHEN TZ_OFFSET('US/Pacific')=TZ_OFFSET('-08:00') THEN 8 ELSE 7 END)/24)) - NVL(ACTUAL_APT_SLA_END,APT_ETA)) * 24 * 60  END) * 100) / (CASE WHEN ((NVL(ACTUAL_APT_SLA_END, APT_ETA) - ACTUAL_APT_SLA_START) * 24 * 60)<=0 THEN 1 ELSE ((NVL(ACTUAL_APT_SLA_END, APT_ETA) - ACTUAL_APT_SLA_START) * 24 * 60) END)),0) APTPERCENT, (CASE NVL(TO_CHAR(ACTUAL_APT_TRAFFIC_SLA_START, 'HH12:MI AM'), 'N')    WHEN 'N' THEN 'Not Started'    ELSE      (CASE NVL(TO_CHAR(ACTUAL_APT_TRAFFIC_SLA_END, 'HH12:MI AM'), 'N')       WHEN 'N' THEN 'Running'       ELSE 'Completed'     END) END) APTTRAFFICLOADSTATUS, (CASE     WHEN ((APT_TRAFFIC_ETA-APT_TRAFFIC_SLA_END)*24*60) <= 0 THEN 'GREEN'   WHEN (((APT_TRAFFIC_ETA-APT_TRAFFIC_SLA_END)*24*60)>0 AND ((APT_TRAFFIC_ETA-APT_TRAFFIC_SLA_END)*24*60) <=60) THEN 'AMBER'   WHEN ((APT_TRAFFIC_ETA-APT_TRAFFIC_SLA_END)*24*60) >60 THEN 'RED' END) APTTRAFFICSTATUS, ROUND((((CASE REGION  WHEN 'APAC' THEN ((sysdate + (5.5/24)) - NVL(ACTUAL_APT_TRAFFIC_SLA_END, APT_TRAFFIC_ETA)) * 24 * 60 WHEN 'EMEA' THEN (sysdate - NVL(ACTUAL_APT_TRAFFIC_SLA_END, APT_TRAFFIC_ETA)) * 24 * 60 ELSE ((sysdate - ((CASE WHEN TZ_OFFSET('US/Pacific')=TZ_OFFSET('-08:00') THEN 8 ELSE 7 END)/24)) - NVL(ACTUAL_APT_TRAFFIC_SLA_END, APT_TRAFFIC_ETA)) * 24 * 60  END) * 100) / (CASE WHEN ((NVL(ACTUAL_APT_TRAFFIC_SLA_END, APT_TRAFFIC_ETA) - ACTUAL_APT_TRAFFIC_SLA_START) * 24 * 60)<=0 THEN 1 ELSE ((NVL(ACTUAL_APT_TRAFFIC_SLA_END, APT_TRAFFIC_ETA) - ACTUAL_APT_TRAFFIC_SLA_START) * 24 * 60) END)),0) APTTRAFFICPERCENT, TO_CHAR(OFA_SLA_START, 'HH12:MI AM') OFASLASTARTTIME,  TO_CHAR(OFA_SLA_END, 'HH12:MI AM') OFASLAENDTIME,  ROUND((((CASE REGION  WHEN 'APAC' THEN ((sysdate + (5.5/24)) - OFA_SLA_END) * 24 * 60 WHEN 'EMEA' THEN (sysdate - OFA_SLA_END) * 24 * 60 ELSE ((sysdate - ((CASE WHEN TZ_OFFSET('US/Pacific')=TZ_OFFSET('-08:00') THEN 8 ELSE 7 END)/24)) - OFA_SLA_END) * 24 * 60  END) * 100) / (CASE WHEN ((OFA_SLA_END - OFA_SLA_START) * 24 * 60)<=0 THEN 1 ELSE ((OFA_SLA_END - OFA_SLA_START) * 24 * 60) END)),0) OFASLAPERCENT, TO_CHAR(ACTUAL_OFA_SLA_START, 'HH12:MI AM') OFASTARTTIME,  TO_CHAR(NVL(ACTUAL_OFA_SLA_END, OFA_ETA), 'HH12:MI AM') OFAENDTIME, (CASE NVL(TO_CHAR(ACTUAL_OFA_SLA_START, 'HH12:MI AM'), 'N')    WHEN 'N' THEN 'Not Started'    ELSE      (CASE NVL(TO_CHAR(ACTUAL_OFA_SLA_END, 'HH12:MI AM'), 'N')       WHEN 'N' THEN 'Running'       ELSE 'Completed'     END) END) OFALOADSTATUS, (CASE     WHEN ((OFA_ETA-OFA_SLA_END)*24*60) <= 0 THEN 'GREEN'   WHEN (((OFA_ETA-OFA_SLA_END)*24*60)>0 AND ((OFA_ETA-OFA_SLA_END)*24*60) <=60) THEN 'AMBER'   WHEN ((OFA_ETA-OFA_SLA_END)*24*60) >60 THEN 'RED' END) OFASTATUS, ROUND((((CASE REGION  WHEN 'APAC' THEN ((sysdate + (5.5/24)) - NVL(ACTUAL_OFA_SLA_END, OFA_ETA)) * 24 * 60 WHEN 'EMEA' THEN (sysdate - NVL(ACTUAL_OFA_SLA_END, OFA_ETA)) * 24 * 60 ELSE ((sysdate - ((CASE WHEN TZ_OFFSET('US/Pacific')=TZ_OFFSET('-08:00') THEN 8 ELSE 7 END)/24)) - NVL(ACTUAL_OFA_SLA_END, OFA_ETA)) * 24 * 60 END) * 100) / (CASE WHEN ((NVL(ACTUAL_OFA_SLA_END, OFA_ETA) - ACTUAL_OFA_SLA_START) * 24 * 60)<=0 THEN 1 ELSE ((NVL(ACTUAL_OFA_SLA_END, OFA_ETA) - ACTUAL_OFA_SLA_START) * 24 * 60) END)),0) OFAPERCENT, TO_CHAR(UAD_SLA_START, 'HH12:MI AM') UADSLASTARTTIME,  TO_CHAR(UAD_SLA_END, 'HH12:MI AM') UADSLAENDTIME,  ROUND((((CASE REGION  WHEN 'APAC' THEN ((sysdate + (5.5/24)) - UAD_SLA_END) * 24 * 60 WHEN 'EMEA' THEN (sysdate - UAD_SLA_END) * 24 * 60 ELSE ((sysdate - ((CASE WHEN TZ_OFFSET('US/Pacific')=TZ_OFFSET('-08:00') THEN 8 ELSE 7 END)/24)) - UAD_SLA_END) * 24 * 60  END) * 100) / (CASE WHEN ((UAD_SLA_END - UAD_SLA_START) * 24 * 60)<=0 THEN 1 ELSE ((UAD_SLA_END - UAD_SLA_START) * 24 * 60) END)),0) UADSLAPERCENT, TO_CHAR(ACTUAL_UAD_SLA_START, 'HH12:MI AM') UADSTARTTIME,  TO_CHAR(NVL(ACTUAL_UAD_SLA_END, UAD_ETA), 'HH12:MI AM') UADENDTIME, (CASE NVL(TO_CHAR(ACTUAL_UAD_SLA_START, 'HH12:MI AM'), 'N')    WHEN 'N' THEN 'Not Started'    ELSE      (CASE NVL(TO_CHAR(ACTUAL_UAD_SLA_END, 'HH12:MI AM'), 'N')       WHEN 'N' THEN 'Running'       ELSE 'Completed'     END) END) UADLOADSTATUS, (CASE     WHEN ((UAD_ETA-UAD_SLA_END)*24*60) <= 0 THEN 'GREEN'   WHEN (((UAD_ETA-UAD_SLA_END)*24*60)>0 AND ((UAD_ETA-UAD_SLA_END)*24*60) <=60) THEN 'AMBER'   WHEN ((UAD_ETA-UAD_SLA_END)*24*60) >60 THEN 'RED' END) UADSTATUS, ROUND((((CASE REGION  WHEN 'APAC' THEN ((sysdate + (5.5/24)) - NVL(ACTUAL_UAD_SLA_END, UAD_ETA)) * 24 * 60 WHEN 'EMEA' THEN (sysdate - NVL(ACTUAL_UAD_SLA_END, UAD_ETA)) * 24 * 60 ELSE ((sysdate - ((CASE WHEN TZ_OFFSET('US/Pacific')=TZ_OFFSET('-08:00') THEN 8 ELSE 7 END)/24)) - NVL(ACTUAL_UAD_SLA_END, UAD_ETA)) * 24 * 60  END) * 100) / (CASE WHEN ((NVL(ACTUAL_UAD_SLA_END, UAD_ETA) - ACTUAL_UAD_SLA_START) * 24 * 60)<=0 THEN 1 ELSE ((NVL(ACTUAL_UAD_SLA_END, UAD_ETA) - ACTUAL_UAD_SLA_START) * 24 * 60) END )),0) UADPERCENT FROM  {0}.VW_UAD_SLA_DASHBOARD WHERE DATA_DATE = ?

#SELECT region, TO_CHAR(APT_SLA_START, ''MM/DD/YYYY HH12:MI:SS AM'') as aptSlaStart, TO_CHAR(APT_SLA_END, ''MM/DD/YYYY HH12:MI:SS AM'') as aptSlaEnd, TO_CHAR(ACTUAL_APT_SLA_START,''MM/DD/YYYY HH12:MI:SS AM'') as aptActualSlaStart,\n \
#TO_CHAR(ACTUAL_APT_SLA_END,''MM/DD/YYYY HH12:MI:SS AM'') as aptActualSlaEnd , TO_CHAR(APT_ETA,''MM/DD/YYYY HH12:MI:SS AM'') as aptEta,TO_CHAR(OFA_SLA_START, ''MM/DD/YYYY HH12:MI:SS AM'') as ofaSlaStart, TO_CHAR(OFA_SLA_END, ''MM/DD/YYYY HH12:MI:SS AM'') as ofaSlaEnd, \n \
#TO_CHAR(ACTUAL_OFA_SLA_START, ''MM/DD/YYYY HH12:MI:SS AM'') as ofaActualSlaStart, TO_CHAR(ACTUAL_OFA_SLA_END, ''MM/DD/YYYY HH12:MI:SS AM'') as ofaActualSlaEnd,TO_CHAR(OFA_ETA, ''MM/DD/YYYY HH12:MI:SS AM'') as ofaEta, TO_CHAR(UAD_SLA_START, ''MM/DD/YYYY HH12:MI:SS AM'') as uadSlaStart,\n \
#TO_CHAR(UAD_SLA_END, ''MM/DD/YYYY HH12:MI:SS AM'') as uadSlaEnd, TO_CHAR(ACTUAL_UAD_SLA_START, ''MM/DD/YYYY HH12:MI:SS AM'') as uadActualSlaStart, TO_CHAR(ACTUAL_UAD_SLA_END, ''MM/DD/YYYY HH12:MI:SS AM'') as uadActualSlaEnd,TO_CHAR(UAD_ETA, ''MM/DD/YYYY HH12:MI:SS AM'') as uadEta, \n \
#TO_CHAR(APT_TRAFFIC_SLA_START, ''MM/DD/YYYY HH12:MI:SS AM'') as aptTrafficSlaStart, TO_CHAR(APT_TRAFFIC_SLA_END, ''MM/DD/YYYY HH12:MI:SS AM'') as aptTrafficSlaEnd,TO_CHAR(ACTUAL_APT_TRAFFIC_SLA_START, ''MM/DD/YYYY HH12:MI:SS AM'') as aptTrafficActualSlaStart,\n \
#TO_CHAR(ACTUAL_APT_TRAFFIC_SLA_END, ''MM/DD/YYYY HH12:MI:SS AM'') as aptTrafficActualSlaEnd, TO_CHAR(APT_TRAFFIC_ETA, ''MM/DD/YYYY HH12:MI:SS AM'') as aptTrafficEta FROM  {0} .VW_UAD_SLA_DASHBOARD WHERE DATA_DATE = ?  order by region

REGION_DETAIL= SELECT region, TO_CHAR(APT_SLA_START, ''MM/DD/YYYY HH12\:MI\:SS AM'') as aptSlaStart, TO_CHAR(APT_SLA_END, ''MM/DD/YYYY HH12\:MI\:SS AM'') as aptSlaEnd, TO_CHAR(ACTUAL_APT_SLA_START,''MM/DD/YYYY HH12\:MI\:SS AM'') as aptActualSlaStart,\n TO_CHAR(ACTUAL_APT_SLA_END,''MM/DD/YYYY HH12\:MI\:SS AM'') as aptActualSlaEnd , TO_CHAR(APT_ETA,''MM/DD/YYYY HH12\:MI\:SS AM'') as aptEta,TO_CHAR(OFA_SLA_START, ''MM/DD/YYYY HH12\:MI\:SS AM'') as ofaSlaStart, TO_CHAR(OFA_SLA_END, ''MM/DD/YYYY HH12\:MI\:SS AM'') as ofaSlaEnd, \n TO_CHAR(ACTUAL_OFA_SLA_START, ''MM/DD/YYYY HH12\:MI\:SS AM'') as ofaActualSlaStart, TO_CHAR(ACTUAL_OFA_SLA_END, ''MM/DD/YYYY HH12\:MI\:SS AM'') as ofaActualSlaEnd,TO_CHAR(OFA_ETA, ''MM/DD/YYYY HH12\:MI\:SS AM'') as ofaEta, TO_CHAR(UAD_SLA_START, ''MM/DD/YYYY HH12\:MI\:SS AM'') as uadSlaStart,\n TO_CHAR(UAD_SLA_END, ''MM/DD/YYYY HH12\:MI\:SS AM'') as uadSlaEnd, TO_CHAR(ACTUAL_UAD_SLA_START, ''MM/DD/YYYY HH12\:MI\:SS AM'') as uadActualSlaStart, TO_CHAR(ACTUAL_UAD_SLA_END, ''MM/DD/YYYY HH12\:MI\:SS AM'') as uadActualSlaEnd,TO_CHAR(UAD_ETA, ''MM/DD/YYYY HH12\:MI\:SS AM'') as uadEta, \n TO_CHAR(APT_TRAFFIC_SLA_START, ''MM/DD/YYYY HH12\:MI\:SS AM'') as aptTrafficSlaStart, TO_CHAR(APT_TRAFFIC_SLA_END, ''MM/DD/YYYY HH12\:MI\:SS AM'') as aptTrafficSlaEnd,TO_CHAR(ACTUAL_APT_TRAFFIC_SLA_START, ''MM/DD/YYYY HH12\:MI\:SS AM'') as aptTrafficActualSlaStart,\n TO_CHAR(ACTUAL_APT_TRAFFIC_SLA_END, ''MM/DD/YYYY HH12\:MI\:SS AM'') as aptTrafficActualSlaEnd, TO_CHAR(APT_TRAFFIC_ETA, ''MM/DD/YYYY HH12\:MI\:SS AM'') as aptTrafficEta FROM  {0} .VW_UAD_SLA_DASHBOARD WHERE DATA_DATE \= ?  and lower(REGION) \= ? order by region
